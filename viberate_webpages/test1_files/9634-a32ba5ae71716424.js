"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9634],{49634:function(a,e,t){t.d(e,{Z:function(){return C}});var s=t(85034),r=t(70169),i=t(52050),n=t(3204),l=t(24246),o=t(27378),c=t(42816),u=t(69305),d=t(75295),m=t(35139),f=t(79620),p=t(13579),k=t(75089),v=t(56326),h=t(52700),y=t(16137),g=t(55682),x=t(93306),Z=t(99574),T=t(98784),_=t(67839);function j(a){var e=a.item,t=a.index,s=a.followedTracksLength,r=a.clickHandler,i=void 0===r?function(){}:r,n=a.removeHandler,c=void 0===n?function(){}:n,u=a.isSelected,d=void 0===u?function(){}:u,m=a.shouldShowResults,f=(0,v.ke)(e,"image",_.mV.GHOST),p=(0,v.ke)(e,"name","N/A"),k=(0,v.ke)(e,"artists",[]),h=d(e),y="";return y=(0,T.isEmpty)(k)||"string"!==typeof k[0]?k.map((function(a){return a.name})).join(", "):k.join(", "),(0,l.jsxs)(o.Fragment,{children:[m&&s&&0===t?(0,l.jsx)("div",{className:"result-item label-title",children:"Followed tracks"}):"",m&&s&&t===s?(0,l.jsx)("div",{className:"result-item divider"}):"",(0,l.jsx)("div",{className:"result-item pointer ".concat(h?"selected removable":""),onClick:function(){h||i(e)},children:(0,l.jsxs)("div",{className:"card-micro song small clickable",children:[(0,l.jsx)("figure",{style:{backgroundImage:"url('".concat(f,"')")}}),(0,l.jsxs)("article",{children:[(0,l.jsx)("h3",{title:p,children:(0,l.jsx)("em",{children:p})}),y?(0,l.jsx)("div",{className:"artists",title:y,children:y}):""]}),h?(0,l.jsx)("div",{className:"track-actions",children:(0,l.jsx)("button",{className:"btn btn-remove-track",onClick:function(a){a.stopPropagation(),c(e)},children:"Remove"})}):""]})})]})}var N=t(73888),b=t(34348);var S=function(a){var e=a.state,t=a.setState,i=a.chartTracks,c=a.header,u=void 0===c||c;return(0,l.jsxs)(l.Fragment,{children:[u?(0,l.jsx)(x.Z,{title:"Cross-Artist Track Compare",titleClasses:"title black"}):"",(0,l.jsx)(g.Z,{leftFilters:(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)(Z.Z,{options:e.timeframeFilter,defaultOption:e.timeframeFilter[2],additionalClasses:"special-toggle-time",onChange:function(a){return t((function(e){return(0,r.Z)((0,s.Z)({},e),{timeframe:a})}))},checkPremium:!0}),(0,l.jsx)(y.Z,{values:e.metricFilter,onChange:function(a){return t((function(e){return(0,r.Z)((0,s.Z)({},e),{metric:a})}))},className:"charts"}),(0,l.jsx)(h.Z,{type:"track",className:"w-260 no-border-results",placeholderText:"Add Track",onClickHandler:function(a){return function(a,e,t){var i=(0,v.ke)(a,"uuid",""),l=(0,v.ke)(a,"artists",[]),o=(0,v.bQ)(l),c=(0,v.ke)(a,"image",_.mV.GHOST),u=(0,v.ke)(a,"name","N/A"),d=(0,v.ke)(a,"slug","N/A"),m=(0,v.ke)(a,"updated_at","N/A");i&&(e((function(a){return(0,r.Z)((0,s.Z)({},a),{loading:!0})})),b.Z.getCrossCompareTracks(i).then((function(a){(0,v.ke)(a,"data",[]).forEach((function(a){var l,f=(0,v.ke)(a,"release_date","N/A"),p={spotify_streams:(0,v.ke)(a,"data.data.spotify.streams.graph",{}),spotify_active_playlists:(0,v.ke)(a,"data.data.spotify.playlists.graph.active_playlists",{}),spotify_playlist_reach:(0,v.ke)(a,"data.data.spotify.playlists.graph.playlists_reach",{}),youtube_views:(0,v.ke)(a,"data.data.youtube.graph[0].views",{}),youtube_likes:(0,v.ke)(a,"data.data.youtube.graph[0].likes",{}),soundcloud_plays:(0,v.ke)(a,"data.data.soundcloud.graph",{}),shazams:(0,v.ke)(a,"data.data.shazam.graph",{}),spins:(0,v.ke)(a,"data.data.airplay.graph",{})},k=N.gy.find((function(a){return!t.tracks.map((function(a){return a.color})).includes(a)})),h={active:!0,artistsNames:o,color:k,graphs:p,image:c,name:u,releaseDate:f,slug:d,updatedAt:m,uuid:i};(null===(l=t.tracks)||void 0===l?void 0:l.length)<10&&!t.loading&&e((function(a){return(0,r.Z)((0,s.Z)({},a),{tracks:(0,n.Z)(a.tracks).concat([h]),loading:!1})}))}))})).catch((function(a){console.error(a),e((function(a){return(0,r.Z)((0,s.Z)({},a),{loading:!1})}))})))}(a,t,e)},disabled:10===e.tracks.length,allResults:(0,n.Z)(i.followingTracks).concat((0,n.Z)(i.topTracks)),renderItem:function(a){var o;return(0,l.jsx)(j,(0,r.Z)((0,s.Z)({},a),{followedTracksLength:null===(o=i.followingTracks)||void 0===o?void 0:o.length,isSelected:function(a){return e.tracks.find((function(e){return e.uuid&&a.uuid&&e.uuid===a.uuid}))},removeHandler:function(a){return function(a){t((function(e){var t=(0,n.Z)(e.tracks);return(0,r.Z)((0,s.Z)({},e),{tracks:t.filter((function(e){return e.uuid!==a.uuid}))})}))}(a)}}))}})]})})]})};function C(a){var e=a.CompareTracksHeader,t=void 0===e?S:e,h=a.graphInterval,y=void 0===h?"weekly":h,g=a.yValsInsideAxis,x=void 0!==g&&g,Z=a.page,T=a.header,j=void 0===T||T,C=a.main,w=void 0===C||C,A=a.additionalClass,F=void 0===A?"":A,O=(0,k.Z)().user,R=Object.keys((0,v.ke)(O,"bookmarks.track",{})),E=(0,m.Z)(p.$.CROSS_ARTIST_COMPARE_TRACKS,!0),H=(0,o.useState)({followingTracks:[],topTracks:[]}),I=H[0],z=H[1],P=(0,o.useState)({tracks:[],filteredTracks:[],sortedTracks:[],loading:!1,timeframeFilter:[{value:"1m",name:"1m"},{value:"3m",name:"3m"},{value:"12m",name:"12m"},{value:"custom",name:"Custom",disabled:!0}],metricFilter:[{value:"spotify_streams",text:"Spotify Streams",className:"spotify"},{value:"spotify_active_playlists",text:"Spotify Active Playlists",className:"spotify"},{value:"spotify_playlist_reach",text:"Spotify Playlist Reach",className:"spotify"},{value:"youtube_views",text:"YouTube Views",className:"youtube"},{value:"youtube_likes",text:"YouTube Likes",className:"youtube"},{value:"soundcloud_plays",text:"SoundCloud Plays",className:"soundcloud"},{value:"shazams",text:"Shazams",className:"shazam"},{value:"spins",text:"Radio Spins",className:"airplay"}],timeframe:{value:"12m",text:"12 Months"},metric:{value:"spotify_streams",text:"Spotify Streams",className:"spotify"},dataTypes:[{value:"streams",text:"Streams"},{value:"royalties",text:"Royalties"}],dataType:{value:"",text:""}}),V=P[0],G=P[1];if((0,o.useEffect)((function(){!function(a,e){a((function(a){return(0,r.Z)((0,s.Z)({},a),{loading:!0})})),b.Z.getCrossCompareTracks(null===e||void 0===e?void 0:e.join(",")).then((function(e){var t=(0,v.ke)(e,"data",[]),i=t.map((function(a,e){var t=(0,v.ke)(a,"uuid"),s=(0,v.ke)(a,"slug"),r=(0,v.ke)(a,"image",_.mV.GHOST),i=(0,v.ke)(a,"name","N/A"),n=(0,v.ke)(a,"artists",[]);return{uuid:t,slug:s,image:r,name:i,artistsNames:(0,v.iu)(n),releaseDate:(0,v.ke)(a,"release_date","N/A"),color:N.gy[e],active:!0}}));t.forEach((function(a,e){var t=(0,v.ke)(a,"data.updated_at","N/A"),s={spotify_streams:(0,v.ke)(a,"data.data.spotify.streams.graph",{}),spotify_active_playlists:(0,v.ke)(a,"data.data.spotify.playlists.graph.active_playlists",{}),spotify_playlist_reach:(0,v.ke)(a,"data.data.spotify.playlists.graph.playlists_reach",{}),youtube_views:(0,v.ke)(a,"data.data.youtube.graph[0].views",{}),youtube_likes:(0,v.ke)(a,"data.data.youtube.graph[0].likes",{}),soundcloud_plays:(0,v.ke)(a,"data.data.soundcloud.graph",{}),shazams:(0,v.ke)(a,"data.data.shazam.graph",{}),spins:(0,v.ke)(a,"data.data.airplay.graph",{})};i[e].updatedAt=t,i[e].graphs=s})),a((function(a){return(0,r.Z)((0,s.Z)({},a),{tracks:i,timeframe:{value:"12m",text:"12 Months"},metric:{value:"spotify_streams",text:"Spotify Streams",className:"spotify"}})}))})).catch((function(e){console.log(e),a((function(a){return(0,r.Z)((0,s.Z)({},a),{tracks:[],filteredTracks:[],loading:!1})}))}))}(G,R.slice(0,5)),function(a){var e="sort=viberate-overall-12m&limit=20";Promise.allSettled([b.Z.getTrackChartOld(e+"&following=true"),b.Z.getTrackChartOld(e)]).then((function(e){var t=(0,v.ke)(e[0],"value.data.data",[]),s=(0,v.ke)(e[1],"value.data.data",[]);a({followingTracks:t,topTracks:s})})).catch((function(){a({followingTracks:[],topTracks:[]})}))}(z)}),[]),(0,o.useEffect)((function(){V.tracks.length&&function(a,e,t){var l=(0,n.Z)(V.tracks).filter((function(a){return a.active&&a.graphs[e.value]})).map((function(t){var s=Object.entries(t.graphs[e.value]);return{color:t.color,data:s.filter((function(e){return(0,v.ON)(e[0],a.value,!0)})).map((function(a){var e=(0,i.Z)(a,2),t=e[0],s=e[1];return{x:parseInt(t),y:s}})),name:t.name}}));G((function(a){var e=a.metricFilter.map((function(e){return(0,r.Z)((0,s.Z)({},e),{disabled:a.tracks.every((function(a){return!Object.keys(a.graphs[e.value]).length}))})}));return(0,r.Z)((0,s.Z)({},a),{filteredTracks:l,metricFilter:e,loading:!1})}))}(V.timeframe,V.metric,V.dataType)}),[V.tracks,V.timeframe,V.metric,V.dataType]),!V.loading&&!V.filteredTracks.length&&!E)return"";var L=(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)(t,{state:V,setState:G,chartTracks:I,header:j}),(0,l.jsx)("article",{className:"pro-content-module-article",children:V.loading?(0,l.jsx)(d.Z,{loaderIconClass:"h-360"}):(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)("div",{className:"col",children:(0,l.jsx)(c.Z,{interval:y,tracks:V.filteredTracks,timeframe:V.timeframe,metric:V.metric,dataType:V.dataType,yValsInsideAxis:x})}),(0,l.jsx)("div",{className:"col",children:(0,l.jsx)(u.Z,{tracks:V.tracks,setState:G})})]})})]});return E||(0,l.jsx)(f.Z,{className:"pro-content-module for-you compare-tracks distribution-compare-tracks ".concat(F," alt-cross"),main:w,children:Z?(0,l.jsx)("div",{className:"page",children:L}):L})}}}]);